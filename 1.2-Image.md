# `<Image>`
[Image Component](https://tinyurl.com/msztpkhm)

此 API reference 將幫助您了解如何 use `props` and `configuration` options available for the `Image` Component。  
For features and usage, please see the Image Component page.

```js
// app/page.js

import Image from 'next/image'

export default function Page() {
  return (
    <Image
      src="/profile.png"
      width={500}
      height={500}
      alt="Picture of the author"
    />
  )
}
```

---

## Configuration Options
除了 props 之外，您還可以在 `next.config.js` 中設定映像檔(configure the Image Component)。可以使用以下選項：

### remotePatterns 遠端模式

為了保護您的應用程式免受惡意使用者的侵害，需要進行設定才能使用外部映像(external images)。這可確保 Next.js 影像最佳化 API 只能提供您帳戶中的外部映像。這些外部映像可以使用 next.config.js 檔案中的 `remotePatterns` 屬性進行配置，如下所示：

```js
// next.config.js

module.exports = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'example.com',
        port: '',
        pathname: '/account123/**',
      },
    ],
  },
}

```
**Good to know:**    
上面的範例將確保 next/image 的 src 屬性必須以 `https://example.com/account123/` 開頭。  
任何其他協定 (protocol)、主機名 (hostname)、連接埠 (port) 或不匹配的路徑 (path) 都將回應 400 Bad Request。

Below is another example of the `remotePatterns` property in the `next.config.js` file:
```js
module.exports = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**.example.com',
      },
    ],
  },
}

```
**Good to know:**    
上面的範例將確保 next/image 的 src 屬性必須以 `https://img1.example.com` 或 `https://me.avatar.example.com` 或任意數量的 subdomains 開頭。   
任何其他協定或不符的主機名都將回應 400 Bad Request。

通配符 模式 (Wildcard patterns)可用於路徑名(pathname)和主機名(hostname)，並具有以下語法：
- `*` 符合單一路徑段或子網域 (match a single path segment or subdomain)
- `**` 匹配 末尾任意數量的路徑段 或 開頭的子域 (match any number of path segments at the end or subdomains at the beginning)

** 語法在模式 中間 不起作用。(The ** syntax does not work in the middle of the pattern.)

### domains
Warning:    
警告：我們建議配置嚴格的 `remotePatterns` 而不是 `domains`，以保護您的應用程式免受惡意使用者的侵害。僅當您擁有 `domain` 提供的所有內容(all the content)時才使用 `domain`。







---

## Props
Here's a summary of the `props` available for the `Image` Component:

|       Prop        |              Example               | Type           | Required |
|-------------------|------------------------------------|----------------|----------|
| src               | src="/profile.png"                 | String         | Yes      | 
| width             | width={500}                        | Integer (px)   | Yes      | 
| height            | height={500}                       | Integer (px)   | Yes      | 
| alt               | alt="Picture of the author"        | String         | Yes      | 
| loader            | loader={imageLoader}               | Function       | -        | 
| fill              | fill={true}                        | Boolean        | -        | 
| sizes             | sizes="(max-width: 768px) 100vw"   | String         | -        | 
| quality           | quality={80}                       | Integer (1-100)| -        | 
| priority          | priority={true}                    | Boolean        | -        | 
| placeholder       | placeholder="blur"                 | String         | -        | 
| style             | style={{objectFit: "contain"}}     | Object         | -        | 
| style             | style={{objectFit: "contain"}}     | Object         | -        | 
| onLoadingComplete | onLoadingComplete={img => done())} | Function       | -        | 
| onLoad            | onLoad={event => done())}          | Function       | -        | 
| onError           | onError(event => fail()}           | Function       | -        | 
| loading           | loading="lazy"                     | String         | -        | 
| blurDataURL       | blurDataURL="data:image/jpeg..."   | String         | -        | 

---
 
## Required Props
Image Component 需要以下屬性：src、width、height 和 alt。

```js
// app/page.js

import Image from 'next/image'
 
export default function Page() {
  return (
    <div>
      <Image
        src="/profile.png"
        width={500}
        height={500}
        alt="Picture of the author"
      />
    </div>
  )
}
```

### src
Must be one of the following:
- A statically imported image file
- A path string。這可以是絕對外部 URL(external URL)，也可以是內部路徑(internal path)，這取決於 loader 屬性(prop)。

使用外部 URL (external URL)時，必須將其新增至 next.config.js 中的 `remotePatterns` 中。

### width
width property 表示以像素為單位的渲染寬度，因此它將影響影像的顯示大小。
是 Required 的，除了:
1. 靜態導入的圖像(statically imported images)
2. 具有 fill 屬性的圖像除外。(images with the fill property.)

### height
height 屬性代表渲染高度（以像素為單位），因此它將影響影像的顯示大小。
是 Required 的，除了:
1. 靜態導入的圖像
2. 具有 fill 屬性的圖像除外。

### alt
`alt` property 用於描述 螢幕閱讀器(screen readers) 和搜尋引擎(search engines)的圖像。如果圖像已停用或載入圖像時發生錯誤，它也是後備文字(fallback text)。

它應該包含可以替換圖像而不改變頁面含義的文字。它並不是(not)為了補充圖像，也不(not)應該重複圖像上方或下方的標題中已經提供的資訊。

如果圖像純粹是裝飾性的或不適合用戶，則 alt 屬性應為空字串 (alt="")。

---

## Optional Props
`<Image />` component 接受除所需屬性之外的許多附加屬性。   
本節介紹 Image 元件最常用(commonly-used)的屬性。    
在“Advanced Props ”部分中查找有關更多 很少使用(rarely-used) 的屬性的詳細資訊。

### loader
用於解析(resolve)圖像 URL 的 custom function。
A `loader` is a function returning a `URL string` for the image，給定以下參數(parameters)：
1. src
2. width
3. quality

Here is an example of using a custom loader:

```js
'use client'
 
import Image from 'next/image'
 
const imageLoader = ({ src, width, quality }) => {
  return `https://example.com/${src}?w=${width}&q=${quality || 75}`
}
 
export default function Page() {
  return (
    <Image
      loader={imageLoader}
      src="me.png"
      alt="Picture of the author"
      width={500}
      height={500}
    />
  )
}
```

**Good to know:**
使用像 `loader` 這樣接受 function 的 props，需要使用 Client Components 來序列化提供的函數(serialize the provided function)。

或者，您可以使用 `next.config.js` 中的 `loaderFile` configuration 來設定應用程式中 next/image 的每個 instance，而無需傳遞 prop。

### fill
```console
fill={true} // {true} | {false}
```

導致圖像填充父元素(fill the parent element)的布林值，這在寬度和高度未知時很有用。

父元素必須指定 `position: "relative", position: "fixed", or position: "absolute"` 樣式。

預設情況下，`img element` 將自動指派 position: "absolute" 樣式。

If no `styles` are applied to the image，圖像將拉伸以適合(stretch to fit)容器。   
您可能更願意為映像設定 `object-fit: "contain"` ，該 image 被加寬以適合容器並保留寬高比( preserve aspect ratio)。

或者，`object-fit: "cover"` 將使 image fill 整個容器並被裁切以保持 aspect ratio。    
為了使其看起來正確，應將 `overflow: "hidden"` 樣式指派給 parent element。

- position
- object-fit
- object-position

### sizes
類似於 media query，提供有關 圖像 在不同 breakpoints 的寬度的資訊。   
value of `sizes` 將極大地影響 for images using `fill` 或樣式為具有 responsive size 的圖像的性能。

`sizes` property 有兩個與 image performance 相關的 important 目的：
1. 首先，瀏覽器使用 `sizes` 的值來決定從 `next/image` 自動產生的 `srcset` 下載圖片的大小。(from next/image's automatically generated srcset)   
   當瀏覽器選擇時，它還不知道頁面上圖像的大小，因此它選擇與 viewport 大小相同或更大的圖像。   
   `sizes` 屬性可讓您告訴 瀏覽器 圖像實際上小於全螢幕。    
   如果您未使用 `fill` 屬性在影像中指定尺寸值，則使用預設值 `100vw`（全螢幕寬度）。
2. 其次，`sizes` 屬性改變了自動產生的 `srcset` 值的行為。   
   - 如果不存在 `sizes` 值，則會產生一個小的 `srcset`，適用於固定尺寸圖像（1x/2x/等）。   
   - 如果定義了`sizes`，則會產生一個大的 `srcset`，適合響應式影像（640w/750w/等）。    
   - 如果 `sizes` 屬性包含諸如 `50vw` 之類的大小（代表 percentage of the viewport width），則 `srcset` 會被修剪以不包含任何太小而不必要的值。
  
例如，如果您知道您的 樣式 將導致圖像在 mobile devices 上為 full-width、在平板電腦上為  2-column 佈局、在桌面顯示器上為 3-column layout，則應包含 `sizes` property，如下所示：

```js
import Image from 'next/image'
 
export default function Page() {
  return (
    <div className="grid-element">
      <Image
        fill
        src="/example.png"
        sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
      />
    </div>
  )
}

```
此範例的 `sizes` 可能會對 效能指標(performance metrics) 產生巨大影響。   
如果沒有 `33vw` 大小，從 server 選擇的影像寬度將是所需寬度的 3 倍。   
由於檔案大小(file size)與寬度的平方成正比，如果沒有 `sizes`，使用者將下載比所需大小大 9 倍的圖像。

### quality
```console
quality={75} // {number 1-100}
```
優化影像的質量，1 到 100 之間的整數，其中 100 是最佳質量，因此也是最大的檔案大小。預設為 75。

### priority
```console
priority={false} // {false} | {true}
```
如果為 true，圖像將被視為 高優先級 並 preload。使用優先權的影像會自動停用延遲載入(lazy loading)。

您應該 對 檢測為 Largest Contentful Paint (LCP)元素的任何影像使用 `priority` property。   
具有多個 優先級 影像 可能是合適的，因為不同的影像可能是不同視口尺寸的LCP元素。
(It may be appropriate to have multiple priority images, as different images may be the LCP element for different viewport sizes.)

僅當影像在首屏上方可見時才應使用(image is visible above the fold)。預設為 `false`。

### placeholder
```console
placeholder = 'empty' // "empty" | "blur" | "data:image/..."
```

載入(loading)圖片時使用的 placeholder。可能的值為`blur`、`empty`或`data:image/...`。預設為`empty`。

當 `blur` 時，`blurDataURL` 屬性將用作 `placeholder`。如果 `src` 是靜態匯入的 object，且匯入的影像是 .jpg、.png、.webp 或 .avif，則會自動填入 blurDataURL，除非 偵測到影像是動畫(animated)的。

對於動態影像(dynamic images)，您必須提供 `blurDataURL` property。 Plaiceholder 等解決方案可以幫助產生 `Base64`。

當 `data:image/...` 時， `Data URL` 將在圖像載入時用作 placeholder。

當為`empty`時，載入影像時不會有 placeholder，只有 empty space。

官方範例
[Demo the blur placeholder](https://tinyurl.com/mu978pna)   
[Demo the shimmer effect with data URL placeholder prop](https://tinyurl.com/mu978pna)    
[Demo the color effect with blurDataURL prop](https://tinyurl.com/yjy7xhhs)   

---

## Advanced Props

## Advanced Props
在某些情況下，您可能需要更進階的用法。 `<Image />` 元件可以選擇接受以下進階屬性。

### style
允許將 CSS 樣式傳遞給底層圖像(underlying image)元素。
```js
// components/ProfileImage.js

const imageStyle = {
  borderRadius: '50%',
  border: '1px solid #fff',
}
 
export default function ProfileImage() {
  return <Image src="..." style={imageStyle} />
}
```
請記住，所需的 寬度 和 高度 props 可以與您的 styling 互動。  
如果您使用樣式來修改影像的寬度，您還應該將其 高度 樣式設為 `auto` 以保留其固有的縱橫比(aspect ratio)，否則您的影像將會扭曲。

### onLoadingComplete
```js
'use client'
 
<Image onLoadingComplete={(img) => console.log(img.naturalWidth)} />
```
A callback function that is invoked once the image is 圖像完全載入 and 佔位符被刪除後.   

回調函數將使用一個參數(argument)來調用，即對底層 <img> 元素的參考。   

**Good to know**    
使用像 `onLoadingComplete` 這樣 accept a function 的 props，需要使用 Client Components 來序列化(serialize)提供的函數(provided function)。

### onLoad
```js
<Image onLoad={(e) => console.log(e.target.naturalWidth)} />
```
載入(loaded)圖片時呼叫的 callback function。

load event 可能會在 圖像佔位符被刪除 和 圖像完全解碼 之前發生。   
如果您想等到圖像 完全加載( fully loaded)，請改用 `onLoadingComplete`。

### onError
```
<Image onError={(e) => console.error(e.target.id)} />
```
A callback function that is invoked if the image fails to load.
**Good to know**  
Using props like onError, which accept a function，需要使用 Client Components 來序列化(serialize)提供的函數(provided function)。

### loading

**Recommendation:**     
此屬性僅適用於進階用例。將影像切換為急切(eager)載入通常會損害效能。我們建議改用 `priority` 屬性，它會急切地預先載入圖片。

```
loading = 'lazy' // {lazy} | {eager}
```

The loading `behavior` of the image。預設為懶惰(lazy)。

當惰性時，延遲載入影像，直到它到達距視窗(viewport)的計算距離。

當急切(eager)時，立即載入圖像(load the image immediately)。

### blurDataURL

在 src 圖片成功載入之前 用作 placeholder 圖像的 Data URL。僅與 `placeholder="blur"` 組合時生效。

必須是 base64 編碼的圖像。它會被放大並模糊，因此建議使用非常小的圖像（10px 或更小）。包含較大的圖像作為佔位符可能會損害您的應用程式效能(application performance)。

- default blurDataURL : [Demo the default blurDataURL prop](https://tinyurl.com/26f24cu4)
- blurDataURL prop : [Demo the color effect with blurDataURL prop](https://tinyurl.com/yjy7xhhs)

You can also generate a [solid color Data URL](https://png-pixel.com/) to match the image.

### unoptimized 未優化的

```js
unoptimized = {false} // {false} | {true}
```
如果為 true，則來源影像將按 原樣提供，而不是更改品質(quality)、大小或格式。預設為 false。

```js
import Image from 'next/image'
 
const UnoptimizedImage = (props) => {
  return <Image {...props} unoptimized />
}
```

從 Next.js 12.3.0 開始，可以透過使用以下配置更新 `next.config.js` 將此 prop 指派給 all images：
```js
// next.config.js

module.exports = {
  images: {
    unoptimized: true,
  },
}
```

### Other Props
`<Image />` 元件上的其他屬性將傳遞給底層 img 元素，但下列屬性除外：
- `srcSet`. Use `Device Sizes` instead.
- `decoding`. It is always "async".













